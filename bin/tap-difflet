#!/usr/bin/env node


var docopt = require('docopt').docopt;

var usage = [
  'Process TAP output on STDIN and print diffs of failed comparisons.',
  '',
  'Usage: tap-difflet [options]',
  '',
  'Options:',
  '  -p --pessimistic  Only output failed tests.',
  '  -v --version      Print the version of tap-difflet.',
  '  -h --help         Show this.',
].join('\n');

var pkg = require('../package.json');
var options = docopt(usage, {
  version: pkg.version,
});


var reporter = require('..')(options);

process.stdin.pipe(reporter).pipe(process.stdout);
process.on('exit', function () {
  process.exit(errors.length);
});
